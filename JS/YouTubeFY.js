//key Neurogram loon 2023-06-15 16:55:22
const loons=$persistentStore.read("字幕位置");const loonn={"单行":"d","第一行,":"one","第二行":"two"};let loonline=loonn[loons]||"d";let url=$request.url;let headers=$request.headers;if(url.match(/\.m3u8/))$done({});let body=$response.body;if(!body)$done({});$httpClient.get({url:`${url}&tlang=zh-Hans`,headers:headers},(function(e,o,d){if(line=="d")$done({body:d});let n=body.match(/<p t="\d+" d="\d+">/g);if(url.match(/&kind=asr/)){body=body.replace(/<\/?s[^>]*>/g,"");d=d.replace(/<\/?s[^>]*>/g,"");n=body.match(/<p t="\d+" d="\d+"[^>]+>/g)}for(var t in n){let e=new RegExp(`${n[t]}([^<]+)<\\/p>`);if(body.match(e)&&d.match(e)){if(line=="two")body=body.replace(e,`${n[t]}$1\n${d.match(e)[1]}</p>`);if(line=="one")body=body.replace(e,`${n[t]}${d.match(e)[1]}\n$1</p>`)}}$done({body:body})}));