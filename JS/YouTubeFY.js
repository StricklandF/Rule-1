//key Neurogram loon 2023-06-15 17:13:26
const loons=$persistentStore.read("字幕位置");const loonn={"仅输出译文":"d","译文位于外文之上":"one","译文位于外文之下":"two"};let line=loonn[loons]||"d";let url=$request.url;let headers=$request.headers;if(url.match(/\.m3u8/))$done({});let body=$response.body;if(!body)$done({});$httpClient.get({url:`${url}&tlang=zh-Hans`,headers:headers},(function(e,o,d){if(line=="d")$done({body:d});let t=body.match(/<p t="\d+" d="\d+">/g);if(url.match(/&kind=asr/)){body=body.replace(/<\/?s[^>]*>/g,"");d=d.replace(/<\/?s[^>]*>/g,"");t=body.match(/<p t="\d+" d="\d+"[^>]+>/g)}for(var n in t){let e=new RegExp(`${t[n]}([^<]+)<\\/p>`);if(body.match(e)&&d.match(e)){if(line=="two")body=body.replace(e,`${t[n]}$1\n${d.match(e)[1]}</p>`);if(line=="one")body=body.replace(e,`${t[n]}${d.match(e)[1]}\n$1</p>`)}}$done({body:body})}));